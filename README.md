# EFD Unpacker

Приложение для распаковки файлов формата EFD.

## Описание

EFD Unpacker - это кроссплатформенное приложение, написанное на Python с использованием PyQt5, которое позволяет легко распаковывать файлы формата EFD. Приложение поддерживает drag & drop, имеет интуитивно понятный интерфейс и работает на Windows, macOS и Linux.

## Возможности

- **Drag & Drop** - перетащите .efd файл прямо в приложение
- **Выбор папки** - укажите папку для распаковки
- **Кнопка сброса пути** - быстрое восстановление пути к папке по умолчанию одной кнопкой
- **Автоматическое создание папки** - если папка для распаковки не существует, она будет создана автоматически
- **Локализация** - поддержка русского и английского языков, все сообщения и интерфейс переведены
- **Кроссплатформа** - работает на Windows, macOS и Linux
- **Современный UI** - адаптивный дизайн для светлой и тёмной темы
- **Файловые ассоциации** - двойной клик по .efd файлам открывает приложение
- **URL схемы** - поддержка efd:// схемы для интеграции с веб-приложениями
- **Командная строка** - запуск с аргументами для автоматизации

## Установка

### Скачать готовую версию

[Releases](https://github.com/IngvarConsulting/efd_unpacker/releases)

### Установка из исходного кода

#### Требования

- Python 3.9+
- PyQt5
- onec_dtools (https://github.com/Infactum/onec_dtools) MIT License

#### Шаги установки

1. Клонируйте репозиторий:
```bash
git clone https://github.com/IngvarConsulting/efd_unpacker.git
cd efd_unpacker
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите приложение:
```bash
python main.py
```

## Использование

### Файловые ассоциации

EFD Unpacker поддерживает полную интеграцию с операционной системой:

#### Двойной клик по файлам
- Дважды кликните на любой .efd файл
- EFD Unpacker автоматически откроется с выбранным файлом
- Файл будет готов к распаковке

#### Drag & Drop на иконку
- Перетащите .efd файл на иконку EFD Unpacker
- Файл автоматически загрузится в приложение

#### Командная строка
```bash
# Открыть конкретный файл
EFDUnpacker /path/to/file.efd

# Использовать URL схему
EFDUnpacker efd:///path/to/file.efd

# Относительные пути
EFDUnpacker ./file.efd
```

#### URL схемы
Поддержка схемы `efd://` для интеграции с веб-приложениями:
```html
<a href="efd:///path/to/file.efd">Открыть в EFD Unpacker</a>
```

Подробная документация по файловым ассоциациям находится в [docs/FILE_ASSOCIATION_GUIDE.md](docs/FILE_ASSOCIATION_GUIDE.md).

### Сброс пути к папке распаковки
Рядом с кнопкой выбора папки есть кнопка со значком восстановления. Она сбрасывает путь к папке по умолчанию для вашей ОС.

## Сборка

### Нативная сборка

Для каждой платформы используйте соответствующий скрипт:

```bash
# macOS
./build_macos.sh

# Linux
./build_linux.sh

# Windows (PowerShell)
.\build_windows.ps1
```

#### Требования для сборки macOS

- **Python 3** - для запуска PyInstaller
- **Homebrew** - для установки create-dmg
- **PyInstaller** - автоматически устанавливается при необходимости
- **create-dmg** - автоматически устанавливается через Homebrew

#### Результаты сборки macOS

Скрипт создает три файла:
- **EFDUnpacker.app** - приложение для macOS
- **EFDUnpacker-<версия>-macos.dmg** - красивый установщик с иконками
- **EFDUnpacker-<версия>-macos.zip** - портативная версия

#### Требования для сборки Linux

- **Python 3** - для запуска PyInstaller
- **PyInstaller** - автоматически устанавливается при необходимости
- **appimagetool** (опционально) - для создания AppImage
- **dpkg-deb** (опционально) - для создания DEB пакетов
- **rpmbuild** (опционально) - для создания RPM пакетов

#### Результаты сборки Linux

Скрипт автоматически определяет доступные инструменты и создает соответствующие дистрибутивы:

**Обязательные файлы:**
- **EFDUnpacker/** - исполняемая папка
- **EFDUnpacker-<версия>-linux.zip** - портативная версия
- **EFDUnpacker-<версия>-linux.tar.gz** - альтернативная портативная версия

**Дополнительные файлы (если доступны инструменты):**
- **EFDUnpacker-<версия>-linux.AppImage** - универсальный пакет (если доступен appimagetool)
- **efd-unpacker_<версия>_amd64.deb** - пакет для Debian/Ubuntu (если доступен dpkg-deb)
- **efd-unpacker-<версия>-1.x86_64.rpm** - пакет для Red Hat/Fedora (если доступен rpmbuild)

#### Требования для сборки Windows

- **Python 3** - для запуска PyInstaller
- **PyInstaller** - автоматически устанавливается при необходимости
- **WiX Toolset** (опционально) - для создания MSI установщика
- **PowerShell** - для запуска скрипта сборки

#### Результаты сборки Windows

Скрипт создает следующие файлы:

**Обязательные файлы:**
- **EFDUnpacker/** - исполняемая папка
- **EFDUnpacker-<версия>-windows.zip** - портативная версия

**Дополнительные файлы (если доступен WiX Toolset):**
- **EFDUnpacker-<версия>-windows.msi** - установщик Windows

#### Опции сборки Windows

PowerShell скрипт поддерживает дополнительные параметры:

```powershell
# Обычная сборка (с MSI если доступен WiX Toolset)
.\build_windows.ps1

# Сборка без MSI установщика
.\build_windows.ps1 -SkipMsi

# Подробный вывод
.\build_windows.ps1 -Verbose
```


## Структура проекта

```
efd_unpacker/
├── main.py              # Главный файл приложения
├── ui.py                # Пользовательский интерфейс
├── localization.py      # Система локализации
├── language_manager.py  # Менеджер языков
├── os_utils.py          # Утилиты для работы с ОС
├── requirements.txt     # Зависимости Python
├── README.md            # Документация проекта
├── LICENSE              # Лицензия
├── build_linux.sh       # Скрипт сборки для Linux
├── build_macos.sh       # Скрипт сборки для macOS
├── build_windows.ps1    # Скрипт сборки для Windows
├── scripts/             # Вспомогательные скрипты
├── resources/           # Ресурсы (иконки)
├── docs/                # Документация
├── dist/                # Сборочные артефакты
└── build/               # Временные файлы сборки
```

## Разработка

### Конвенция коммитов

Проект использует [Conventional Commits](https://www.conventionalcommits.org/) для стандартизации сообщений коммитов. Это обеспечивает автоматическое создание changelog и семантическое версионирование.

Подробная документация: [docs/COMMIT_CONVENTION.md](docs/COMMIT_CONVENTION.md)

#### Быстрый старт

```bash
# Новые функции
git commit -m "feat: добавлена поддержка drag & drop"

# Исправления ошибок
git commit -m "fix(build): исправлена сборка MSI на Windows"

# Документация
git commit -m "docs: обновлен README с новыми функциями"

# Рефакторинг
git commit -m "refactor(ui): вынесена логика в отдельный модуль"
```

### Зависимости

- `PyQt5>=5.15.9,<5.16` - GUI фреймворк
- `onec_dtools=0.5.0` - библиотека для работы с EFD файлами

### Запуск в режиме разработки

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск приложения
python main.py
```

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл [LICENSE](LICENSE) для получения дополнительной информации.

## Поддержка

Если у вас возникли проблемы или вопросы:

1. Проверьте [Issues](https://github.com/IngvarConsulting/efd_unpacker/issues)
2. Создайте новый Issue с описанием проблемы
3. Укажите версию приложения и операционную систему

## Документация по локализации

Добавьте ссылку на `docs/LOCALIZATION_README.md` для разработчиков.
