# CLI-режим EFD Unpacker

EFDUnpacker поддерживает два режима работы из командной строки: с графическим интерфейсом (GUI) и полностью без GUI (автоматическая распаковка).

## 1. CLI-режим с GUI

Если вы запускаете EFDUnpacker и передаёте путь к .efd-файлу **без ключа unpack**, откроется графический интерфейс, и файл будет выбран для распаковки.

### Пример:

```bash
EFDUnpacker ~/Downloads/SSL_3_1_11_228_setup1c/1cv8.efd
```

  Откроется окно приложения, выбранный файл будет готов к распаковке.

Этот режим удобен для интеграции с файловыми ассоциациями, drag & drop, открытия через контекстное меню и других сценариев, когда требуется визуальный контроль перед распаковкой.

---

## 2. CLI-режим без GUI (автоматическая распаковка)

Если вы используете команду с ключом `unpack`, распаковка происходит полностью в консоли, без открытия окна.

### Формат команды:

```bash
EFDUnpacker unpack /path/to/file.efd -tmplts /path/to/output_dir
```

- `/path/to/file.efd` — путь к EFD-файлу для распаковки
- `/path/to/output_dir` — папка, куда будут распакованы файлы

### Пример:

```bash
EFDUnpacker unpack ~/Downloads/SSL_3_1_11_228_setup1c/1cv8.efd -tmplts ~/Downloads/SSL
```

### Поведение
- Если распаковка прошла успешно, в консоль будет выведено сообщение:
  ```
  [OK] Unpacked /path/to/file.efd to /path/to/output_dir
  ```
  и программа завершится с кодом 0.
- В случае ошибки будет выведено сообщение:
  ```
  [ERROR] ...
  ```
  и программа завершится с кодом 1 или 2.

### Особенности
- При использовании этого режима окно приложения не открывается.
- Можно использовать в скриптах, автоматизации, CI/CD.
- Поддерживаются абсолютные и относительные пути.
- Если папку, куда будет происходить распаковка, не создана, она создается автоматически.

---

## Интеграция с PATH

| Платформа            | Вариант поставки      | Автоматически в PATH? | Как реализовано?                                      |
|----------------------|----------------------|----------------------|-------------------------------------------------------|
| **macOS**            | DMG/portable         | ❌                   | Только вручную (пример ниже)                          |
| **Windows**          | MSI-установщик       | ✅ (по выбору)        | Через WiX, опция при установке                        |
| **Windows**          | portable             | ❌                   | Только вручную (пример ниже)                          |
| **Linux**            | DEB/RPM              | ✅                   | postinst-скрипт, symlink в /usr/local/bin             |
| **Linux**            | AppImage             | ❌                   | Только вручную (пример ниже)                          |
| **Linux**            | portable             | ❌                   | Только вручную (пример ниже)                          |

- Для macOS, AppImage и portable-версий всех платформ: добавьте путь к исполняемому файлу в PATH стандартными средствами вашей ОС (см. примеры ниже).
- Для Windows (MSI) и Linux (DEB/RPM): интеграция с PATH происходит автоматически при установке.

### Примеры ручного добавления в PATH

#### macOS (portable-версия)

```bash
# Если вы разархивировали portable-версию, например, в ~/Applications
ln -s ~/Applications/EFDUnpacker.app/Contents/MacOS/EFDUnpacker /usr/local/bin/EFDUnpacker
```
или временно для текущей сессии:
```bash
export PATH="$PATH:$HOME/Applications/EFDUnpacker.app/Contents/MacOS"
```

#### Linux AppImage

```bash
# Сделайте AppImage исполняемым
chmod +x efd-unpacker-<version>-linux.AppImage

# Создайте симлинк для глобального запуска
sudo ln -s /path/to/efd-unpacker-<version>-linux.AppImage /usr/local/bin/EFDUnpacker
```

#### Linux portable

```bash
# Сделайте бинарник исполняемым
chmod +x EFDUnpacker

# Создайте симлинк для глобального запуска
sudo ln -s /path/to/EFDUnpacker /usr/local/bin/EFDUnpacker
```
или временно для текущей сессии:
```bash
export PATH="$PATH:/path/to/portable/folder"
```

#### Windows portable

1. Откройте "Свойства системы" → "Дополнительные параметры системы" → "Переменные среды".
2. В разделе "Системные переменные" найдите переменную `Path` и нажмите "Изменить".
3. Добавьте путь к папке, где лежит `EFDUnpacker.exe` (например, `C:\Users\User\Downloads`).
4. Сохраните изменения и перезапустите консоль.

Теперь можно запускать `EFDUnpacker` из любой папки в командной строке.

---

## Совместимость

CLI-режим работает на всех поддерживаемых платформах (Windows, Linux, macOS).

---

## См. также
- [README.md](../README.md) — краткое описание и быстрый старт
- [docs/FILE_ASSOCIATION_GUIDE.md](FILE_ASSOCIATION_GUIDE.md) — интеграция с ОС и ассоциации файлов 